<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S89T1U707">BRANCH_CUT_MATRIX</span>, <span class="var type1" id="S90T1U708">FLAGS_MATRIX</span>] = place_branch_cut(<span class="mxinfo " id="T1:U3"><span class="mxinfo " id="T1:U4"><span class="var type1" id="S89T1U711">BRANCH_CUT_MATRIX</span></span></span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line">    <span class="mxinfo " id="T1:U6"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S90T1U712">FLAGS_MATRIX</span></span></span>, <span class="var type1" id="S91T30U713">POINTS_01</span>, <span class="var type1" id="S92T30U714">POINTS_02</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line"><span class="comment">% This function places a branch cut in the branch cut matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"><span class="comment">% This is the little-endian bit position of the </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line"><span class="comment">% bit in each 8-bit element of the FLAGS_MATRIX array that indicates</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"><span class="comment">% whether or not the pixel lies on a branch cut. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line"><span class="mxinfo " id="T2:U11"><span class="var type1" id="S93T2U717">branch_cut_bit_position</span> = <span class="mxinfo " id="T2:U13">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line"><span class="comment">% Determine size of matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S94T2U721">height</span> = <span class="mxinfo " id="T2:U16">size(<span class="var type1" id="S89T1U724">BRANCH_CUT_MATRIX</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line"><span class="comment">% Find the pixels corresponding to the branch cut</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line">[<span class="mxinfo " id="T34:U18"><span class="var type1" id="S96T34U729">branch_cut_rows</span></span>, <span class="mxinfo " id="T34:U20"><span class="var type1" id="S97T34U730">branch_cut_cols</span></span>] = <span class="fcn" id="F327N5:B732">find_branch_cut_pixels</span>(<span class="var type1" id="S91T30U733">POINTS_01</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line">                                                            <span class="var type1" id="S92T30U734">POINTS_02</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line"><span class="comment">% Find the indices of the branch cut pixels.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line"><span class="mxinfo " id="T34:U24"><span class="var type1" id="S99T34U737">branch_cut_indices</span> = <span class="mxinfo " id="T34:U26"><span class="var type1" id="S96T34U739">branch_cut_rows</span> + <span class="mxinfo " id="T34:U28">(<span class="mxinfo " id="T34:U29"><span class="var type1" id="S97T34U743">branch_cut_cols</span> - <span class="mxinfo " id="T2:U31">1</span></span>) * <span class="var type1" id="S94T2U745">height</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line"><span class="comment">% Set the "branch cut" flag to one at the branch cut indices.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line"><span class="mxinfo " id="T50:U33"><span class="mxinfo " id="T50:U34"><span class="var type1" id="S90T1U749">FLAGS_MATRIX</span>(<span class="var type1" id="S99T34U750">branch_cut_indices</span>)</span> = <span class="mxinfo " id="T50:U37">bitset( <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line"><span class="mxinfo " id="T50:U33"><span class="mxinfo " id="T50:U37">    <span class="mxinfo " id="T50:U38"><span class="var type1" id="S90T1U754">FLAGS_MATRIX</span>(<span class="var type1" id="S99T34U755">branch_cut_indices</span>)</span>, <span class="var type1" id="S93T2U756">branch_cut_bit_position</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line">                                                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line"><span class="comment">% Set those pixels to one in the branch cut matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line"><span class="mxinfo " id="T50:U42"><span class="mxinfo " id="T50:U43"><span class="var type1" id="S89T1U761">BRANCH_CUT_MATRIX</span>(<span class="var type1" id="S99T34U762">branch_cut_indices</span>)</span> = <span class="mxinfo " id="T2:U46">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">                                                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line"><span class="comment">% Determine the positions of all of the residues in the box.</span></span></span>
</pre>
