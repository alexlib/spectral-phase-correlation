<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409">409</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,410" id="srcline410">410</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S132T1U952">BRANCH_CUT_MATRIX</span>, <span class="var type1" id="S133T1U953">FLAGS_MATRIX</span>] = branch_cut_to_edge(<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,411" id="srcline411">411</a></span><span class="line">    <span class="mxinfo " id="T1:U3"><span class="mxinfo " id="T1:U4"><span class="var type1" id="S132T1U956">BRANCH_CUT_MATRIX</span></span></span>, <span class="mxinfo " id="T1:U6"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S133T1U957">FLAGS_MATRIX</span></span></span>, <span class="var type1" id="S134T30U958">LOC</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,412" id="srcline412">412</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,413" id="srcline413">413</a></span><span class="line"><span class="comment">% Measure height and width of the branch cut matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,414" id="srcline414">414</a></span><span class="line"><span class="mxinfo " id="T2:U10">[<span class="var type1" id="S135T2U962">height</span>, <span class="var type1" id="S136T2U963">width</span>] = size(<span class="var type1" id="S132T1U966">BRANCH_CUT_MATRIX</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,415" id="srcline415">415</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,416" id="srcline416">416</a></span><span class="line"><span class="comment">% Row and column positions of branch cut origin.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417">417</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S138T2U969">row</span> = <span class="mxinfo " id="T2:U16"><span class="var type1" id="S134T30U971">LOC</span>(<span class="mxinfo " id="T2:U18">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418">418</a></span><span class="line"><span class="mxinfo " id="T2:U19"><span class="var type1" id="S139T2U975">col</span> = <span class="mxinfo " id="T2:U21"><span class="var type1" id="S134T30U977">LOC</span>(<span class="mxinfo " id="T2:U23">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419">419</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420">420</a></span><span class="line"><span class="comment">% Calculate distance from the pixel to the edges</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421">421</a></span><span class="line"><span class="mxinfo " id="T51:U24"><span class="var type1" id="S140T51U981">edge_distances</span> = <span class="mxinfo " id="T51:U26">[<span class="var type1" id="S138T2U984">row</span>, <span class="mxinfo " id="T2:U28"><span class="var type1" id="S135T2U986">height</span> - <span class="var type1" id="S138T2U987">row</span></span>, <span class="var type1" id="S139T2U988">col</span>, <span class="mxinfo " id="T2:U32"><span class="var type1" id="S136T2U990">width</span> - <span class="var type1" id="S139T2U991">col</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422">422</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423">423</a></span><span class="line"><span class="comment">% Edge coordinates: top, bottom, left, right</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424">424</a></span><span class="line"><span class="mxinfo " id="T52:U35"><span class="var type1" id="S141T52U994">edge_coords</span> = <span class="mxinfo " id="T52:U37">[<span class="mxinfo " id="T30:U38"><span class="mxinfo " id="T2:U39">1</span>, <span class="var type1" id="S139T2U998">col</span></span>; <span class="mxinfo " id="T30:U41"><span class="var type1" id="S135T2U1000">height</span>, <span class="var type1" id="S139T2U1001">col</span></span>; <span class="mxinfo " id="T30:U44"><span class="var type1" id="S138T2U1003">row</span>, <span class="mxinfo " id="T2:U46">1</span></span>; <span class="mxinfo " id="T30:U47"><span class="var type1" id="S138T2U1006">row</span>, <span class="var type1" id="S136T2U1007">width</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425">425</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426">426</a></span><span class="line"><span class="comment">% Find the location of the minimum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427">427</a></span><span class="line">[<span class="mxinfo " id="T2:U50"><span class="mxinfo " id="T2:U51">~</span></span>, <span class="mxinfo " id="T2:U52"><span class="var type1" id="S142T2U1012">min_loc</span></span>] = min(<span class="var type1" id="S140T51U1015">edge_distances</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428">428</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429">429</a></span><span class="line"><span class="comment">% Coordinates on border to connect with a branch cut.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430">430</a></span><span class="line"><span class="mxinfo " id="T30:U55"><span class="var type1" id="S144T30U1018">border_cut_pos</span> = <span class="mxinfo " id="T30:U57"><span class="var type1" id="S141T52U1020">edge_coords</span>(<span class="var type1" id="S142T2U1021">min_loc</span>, :)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431">431</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432">432</a></span><span class="line"><span class="comment">% Place the branch cut.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433">433</a></span><span class="line">[<span class="mxinfo " id="T1:U60"><span class="var type1" id="S132T1U1026">BRANCH_CUT_MATRIX</span></span>, <span class="mxinfo " id="T1:U62"><span class="var type1" id="S133T1U1027">FLAGS_MATRIX</span></span>] = <span class="fcn" id="F336N7:B1029">place_branch_cut</span>(<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434">434</a></span><span class="line">    <span class="var type1" id="S132T1U1030">BRANCH_CUT_MATRIX</span>, <span class="var type1" id="S133T1U1031">FLAGS_MATRIX</span>, <span class="var type1" id="S134T30U1032">LOC</span>, <span class="var type1" id="S144T30U1033">border_cut_pos</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435">435</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436">436</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437">437</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438">438</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439">439</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,440" id="srcline440">440</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,441" id="srcline441">441</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,442" id="srcline442">442</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,443" id="srcline443">443</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,444" id="srcline444">444</a></span><span class="line"></span></span>
</pre>
