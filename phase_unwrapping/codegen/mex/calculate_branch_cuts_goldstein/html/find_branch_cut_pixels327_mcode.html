<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S69T34U612">BRANCH_CUT_ROWS</span>, <span class="var type1" id="S70T34U613">BRANCH_CUT_COLS</span>] = find_branch_cut_pixels(<span class="var type1" id="S71T30U616">POINTS_01</span>, <span class="var type1" id="S72T30U617">POINTS_02</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line"><span class="comment">% These are the coordinates of the first point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo " id="T2:U5"><span class="var type1" id="S73T2U620">r1</span> = <span class="mxinfo " id="T2:U7"><span class="var type1" id="S71T30U622">POINTS_01</span>(<span class="mxinfo " id="T2:U9">1</span>)</span></span>; <span class="comment">% Row</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S74T2U626">c1</span> = <span class="mxinfo " id="T2:U12"><span class="var type1" id="S71T30U628">POINTS_01</span>(<span class="mxinfo " id="T2:U14">2</span>)</span></span>; <span class="comment">% Column</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line"><span class="comment">% These are the coordinates of the second first point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line"><span class="mxinfo " id="T2:U15"><span class="var type1" id="S75T2U632">r2</span> = <span class="mxinfo " id="T2:U17"><span class="var type1" id="S72T30U634">POINTS_02</span>(<span class="mxinfo " id="T2:U19">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"><span class="mxinfo " id="T2:U20"><span class="var type1" id="S76T2U638">c2</span> = <span class="mxinfo " id="T2:U22"><span class="var type1" id="S72T30U640">POINTS_02</span>(<span class="mxinfo " id="T2:U24">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line"><span class="comment">% Place a branch cut between the anchor pixel and the </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line"><span class="comment">% residue found in the box.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line"><span class="comment">% This is the difference in row positions between the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"><span class="comment">% two residues.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line"><span class="mxinfo " id="T2:U25"><span class="var type1" id="S77T2U644">row_distance</span> = <span class="mxinfo " id="T2:U27"><span class="var type1" id="S75T2U646">r2</span> - <span class="var type1" id="S73T2U647">r1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line"><span class="comment">% This is the difference in column positions between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="comment">% the two residues.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line"><span class="mxinfo " id="T2:U30"><span class="var type1" id="S78T2U650">col_distance</span> = <span class="mxinfo " id="T2:U32"><span class="var type1" id="S76T2U652">c2</span> - <span class="var type1" id="S74T2U653">c1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="comment">% Euclidian distance between the two residues</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"><span class="mxinfo " id="T2:U35"><span class="var type1" id="S79T2U656">euc_distance</span> = <span class="mxinfo " id="T2:U37">floor(<span class="mxinfo " id="T2:U38">sqrt(<span class="mxinfo " id="T2:U39"><span class="mxinfo " id="T2:U40"><span class="var type1" id="S77T2U663">row_distance</span> .^2</span> + <span class="mxinfo " id="T2:U42"><span class="var type1" id="S78T2U666">col_distance</span> .^2</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"><span class="comment">% Angle between the residues</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="mxinfo " id="T2:U44"><span class="var type1" id="S82T2U670">residue_angle</span> = <span class="mxinfo " id="T2:U46">atan2(<span class="var type1" id="S77T2U673">row_distance</span>, <span class="var type1" id="S78T2U674">col_distance</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"><span class="comment">% Euclidean distance vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line"><span class="mxinfo " id="T34:U49"><span class="var type1" id="S84T34U677">euc_vector</span> = <span class="mxinfo " id="T34:U51">0 : <span class="var type1" id="S79T2U680">euc_distance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="comment">% Row pixels in the branch cut</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"><span class="mxinfo " id="T34:U53"><span class="var type1" id="S69T34U683">BRANCH_CUT_ROWS</span> = <span class="mxinfo " id="T34:U55">round(<span class="mxinfo " id="T34:U56"><span class="var type1" id="S73T2U687">r1</span> + <span class="mxinfo " id="T34:U58"><span class="var type1" id="S84T34U689">euc_vector</span> * <span class="mxinfo " id="T2:U60">sin(<span class="var type1" id="S82T2U692">residue_angle</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"><span class="comment">% Column pixels in the branch cut</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"><span class="mxinfo " id="T34:U62"><span class="var type1" id="S70T34U695">BRANCH_CUT_COLS</span> = <span class="mxinfo " id="T34:U64">round(<span class="mxinfo " id="T34:U65"><span class="var type1" id="S74T2U699">c1</span> + <span class="mxinfo " id="T34:U67"><span class="var type1" id="S84T34U701">euc_vector</span> * <span class="mxinfo " id="T2:U69">cos(<span class="var type1" id="S82T2U704">residue_angle</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line"></span></span>
</pre>
